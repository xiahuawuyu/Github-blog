title: 接口调试（中）——一种解决方案
tags:
---
## 契约测试的可行性方案：
>缩写：
>前端 - FE（front end）
>本地 - L（local）
>测试 - T（test）
>服务器 - S（server）
>后端 - BE（back end）
>接口 - API（application programming interface）
>开发 - D（development）

            
    FE L S <——> FE T S <——> API S <——> BE T S <——> BE L S 
                                        ^
                                        |
                                         ——> BE D S

###（API S）接口服务器说明：
由前端主导，前后端在测试服务器上共同编写接口，主要提供接口数据的json定义和文字说明。
根据接口文档生成前端调试代码、数据和后端调试代码，分别部署于前端测试服务器和后端测试服务器。
如果出现接口修改等情况，重新生成接口文档和调试代码，并部署重启测试服务器

###（FE T S）前端测试服务器说明：
为前端提供假数据。类似通常调试用的xxx.get.html和xxx.json文件，不过它不查询数据库，也不处理复杂的业务逻辑。只根据根据请求路径和参数来返回假数据。
校验前端请求参数。当前端参数不符合接口定义时，抛出异常。

###（BE T S）后端测试服务器说明：
发送请求给后端本地服务器。后端人员开发完成接口后，通过后端测试服务器操作，手动发送请求进行联调。
校验请求返回结果。当返回结果与接口定义不一致时抛出异常。
定时任务测试开发环境接口。确保开发环境的接口跟本地调试接口一致。

### 补充：
开始考虑用node.js代替现在client端，技术上是可行的，不过时间成本太大，风险较高。这一套方案的好处对现有的pc端架构基本不改动，只需要将服务器配置指向测试服务器即可。而测试服务器和接口服务器都是新增的，不会对已有项目产生影响。
避免了前后端接口调试的痛苦过程，开发人员只需和自己的测试服务器进行联调即可。在接口配置不变的情况下，与测试服务器的调试成功后，前后端部署代码即可保证与调试结果一致。
前端测试服务器用java的mock工具，后端测试服务器只包含一些测试代码，对本地开发环境进行手动测试，同时对开发环境进行定时测试，以防止代码更新等问题。接口服务器是关键，生成的代码必须保证前后端测试结果一致性，这里考虑用swagger生成。

- - -
>原文作者：亚里士朱德
>博客网址：http://yalishizhude.github.io